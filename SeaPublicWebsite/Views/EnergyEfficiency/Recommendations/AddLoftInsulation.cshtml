@using GovUkDesignSystem
@using GovUkDesignSystem.GovUkDesignSystemComponents
@using Microsoft.CodeAnalysis.CSharp.Syntax
@using SeaPublicWebsite.DataModels
@using SeaPublicWebsite.Models.EnergyEfficiency.Recommendations
@model SeaPublicWebsite.Models.EnergyEfficiency.RecommendationViewModel;

@{
    ViewBag.Title = "Recommendation " + (Model.GetCurrentIndex() + 1) + " of " + Model.UserDataModel.UserRecommendations.Count;
}

<div class="govuk-panel govuk-panel--confirmation sea-recommendations-panel govuk-!-margin-bottom-9">
    <div class="govuk-grid-row">
        <div class="govuk-grid-column-two-thirds govuk-!-text-align-left">
            <span class="govuk-caption-l">Your goal</span>
            <h1 class="govuk-panel__title govuk-!-margin-bottom-3">
                To reduce my energy bills
            </h1>
            <a href="@Url.Action("AnswerSummary", "EnergyEfficiency", new {reference = Model.UserDataModel.Reference})" class="govuk-link govuk-link--inverse">Change my answers</a>
        </div>
        <div class="govuk-grid-column-one-third govuk-!-padding-0">
            <p class="govuk-body-l sea-reference">Your reference <strong>@Model.UserDataModel.Reference</strong></p>
        </div>
    </div>
</div>

<div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">
        <form action="@Url.Action("Recommendation_Post", "EnergyEfficiency", new {id = (int)Model.UserRecommendation.Key, reference = Model.UserDataModel.Reference})" method="post" novalidate>

        @Html.HiddenFor(m => m.UserDataModel.Reference)

        <span class="govuk-caption-l">
            Recommendation @(Model.GetCurrentIndex() + 1) of @Model.UserDataModel.UserRecommendations.Count 
        </span>
        <h1 class="govuk-heading-l">Add more loft insulation</h1>

        <p class="govuk-body">
            It looks like you have some insulation in your loft but it’s less
            than the recommended amount. It could be worthwhile adding some more
            to bring it up to the recommended thickness of 300mm, or 12 inches.
        </p>

        <p class="govuk-body">
            Adding extra insulation can help trap the heat inside your property so your
            heating doesn’t need to be on as much.
        </p>

        <p class="govuk-body">
            If some of your loft is boarded so that you can store things up there
            you will either need to raise this boarding up and insulate underneath
            it, or leave that part of the loft with thinner insulation.
        </p>

        <p class="govuk-body govuk-!-margin-bottom-6">
            You can find more information on floor insulation on the
            <a class="govuk-link" target="_blank" href="https://energysavingtrust.org.uk/advice/roof-and-loft-insulation/">Energy Saving Trust website.<span class="govuk-visually-hidden">(opens in a new window)</span></a>
        </p>

        <h2 class="govuk-heading-m">Who this improvement is suitable for</h2>
        <p class="govuk-body">You should consider this improvement for your property if:</p>
        <ul class="govuk-list govuk-list--bullet govuk-!-margin-bottom-7">
            <li>
                You have a pitched (sloping) roof with an unheated loft space that someone could easily get into.
            </li>
            <li>
                Your loft has less than the recommended amount of insulation. This is 300mm or 12 inches thick.
            </li>
        </ul>

        <h2 class="govuk-heading-m ">What you could save</h2>
        <div class="govuk-grid-row govuk-!-margin-left-0 govuk-!-margin-bottom-7 govuk-!-margin-top-6">
            <div class="govuk-grid-column-one-half sea-install-costs">
                <span class="govuk-caption-m ">This could cost</span>
                <h3 class="govuk-heading-l govuk-!-margin-bottom-1">£@Model.UserRecommendation.MinInstallCost - £@Model.UserRecommendation.MaxInstallCost</h3>
            </div>
            <div class="govuk-grid-column-one-half sea-yearly-savings">
                <span class="govuk-caption-m">This could save up to</span>
                <h3 class="govuk-heading-l govuk-!-margin-bottom-1">£@Model.UserRecommendation.Saving a year</h3>
            </div>
        </div>
        <dl class="govuk-summary-list govuk-!-margin-bottom-9">
            <div class="govuk-summary-list__row">
                <dt class="govuk-summary-list__key govuk-!-width-two-thirds">
                    Will this cause disruption during installation?
                </dt>
                <dd class="govuk-summary-list__value sea-recommendation-impact govuk-!-padding-right-0">
                    <strong class="govuk-tag govuk-tag--green">MINIMAL</strong>
                </dd>
            </div>
            <div class="govuk-summary-list__row">
                <dt class="govuk-summary-list__key govuk-!-width-two-thirds">
                    How long could this take to install?
                </dt>
                <dd class="govuk-summary-list__value sea-recommendation-impact govuk-!-padding-right-0">
                    <strong class="govuk-tag govuk-tag--green">LESS THAN A DAY</strong>
                </dd>
            </div>
        </dl>
            
        @(Html.GovUkRadiosFor(m => m.RecommendationAction,
            fieldsetOptions: new FieldsetViewModel
            {
                Legend = new LegendViewModel
                {
                    Html = @<text>
                               <h1 class="govuk-fieldset__heading">
                                   What would you like to do with this recommendation?
                               </h1>
                            </text>,
                    Classes = "govuk-fieldset__legend--l"
                }
            },
            classes: "govuk-!-margin-bottom-7"
            ))

            @if (Model.HasPreviousIndex())
            {
                <button name="command" value="goBackwards" class="govuk-button govuk-button--secondary  govuk-!-margin-right-4" data-module="govuk-button">
                    Previous recommendation @(Model.GetCurrentIndex())
                </button>
            }
            @if (Model.HasNextIndex())
            {
                <button name="command" value="goForwards" class="govuk-button" data-module="govuk-button">
                    Next recommendation @(Model.GetCurrentIndex() + 2)
                </button>
            }
            else
            {
                <button name="command" value="goToActionPlan" class="govuk-button govuk-button" data-module="govuk-button">
                    Go to action plan
                </button>
            }
        </form>
    </div>
    <div class="govuk-grid-column-one-third">
        <aside class="sea-recommendation-side-panel" role="complementary">
            <h2 class="govuk-heading-m" id="subsection-title">Keep a copy</h2>
            <p class="govuk-body-s">
                <a href=# class="govuk-link">Print or email this recommendation</a>
            </p>
            <h2 class="govuk-heading-m" id="subsection-title">Your action plan</h2>
            @if (Model.GetSavedRecommendations().Count > 0)
            {
                <p class="govuk-body-s">
                    You have saved <strong>@Model.GetSavedRecommendations().Count</strong> recommended improvement.
                </p>
                <dl class="govuk-summary-list">
                    <div class="govuk-summary-list__row">
                        <dt class="govuk-summary-list__key govuk-!-width-one-half govuk-!-margin-bottom-0">
                            @(Model.GetSavedRecommendations().Count == 1 ? "It could cost" : "They could cost")
                        </dt>
                        <dd class="govuk-summary-list__value govuk-!-width-one-half govuk-!-padding-right-0">
                            @Model.GetTotalInstallationCostText()
                        </dd>
                    </div>
                    <div class="govuk-summary-list__row">
                        <dt class="govuk-summary-list__key govuk-!-width-one-half govuk-!-margin-bottom-0">
                            You could save
                        </dt>
                        <dd class="govuk-summary-list__value govuk-!-width-one-half">
                            @Model.GetTotalSavingText()
                        </dd>
                    </div>
                </dl>
                <a href="@Url.Action("YourSavedRecommendations_Get", "EnergyEfficiency", new {reference = Model.UserDataModel.Reference})" class="govuk-link">View your action plan</a>
            }
            else
            {
                <p class="govuk-body-s">You haven’t saved any improvements yet.</p>
            }
        </aside>
    </div>
</div>