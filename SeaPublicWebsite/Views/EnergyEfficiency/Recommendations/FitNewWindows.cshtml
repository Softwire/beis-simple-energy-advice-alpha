@using GovUkDesignSystem
@using GovUkDesignSystem.GovUkDesignSystemComponents
@using SeaPublicWebsite.Helpers
@using SeaPublicWebsite.Models.EnergyEfficiency.QuestionOptions
@model SeaPublicWebsite.Models.EnergyEfficiency.RecommendationViewModel;

@{
    ViewBag.Title = "Recommendation " + (Model.GetCurrentIndex() + 1) + " of " + Model.UserDataModel.UserRecommendations.Count;
}

<div class="govuk-panel govuk-panel--confirmation sea-recommendations-panel govuk-!-margin-bottom-9">
    <div class="govuk-grid-row">
        <div class="govuk-grid-column-two-thirds govuk-!-text-align-left">
            <span class="govuk-caption-l">Your goal</span>
            <h1 class="govuk-panel__title govuk-!-margin-bottom-3">
                To reduce my energy bills
            </h1>
            <a href="@Url.Action("AnswerSummary", "EnergyEfficiency", new {reference = Model.UserDataModel.Reference})" class="govuk-link govuk-link--inverse">Change my answers</a>
        </div>
        <div class="govuk-grid-column-one-third govuk-!-padding-0">
            <p class="govuk-body-l sea-reference">Your reference <strong>@Model.UserDataModel.Reference</strong></p>
        </div>
    </div>
</div>

<div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">
        <form action="@Url.Action("Recommendation_Post", "EnergyEfficiency", new {id = (int)Model.UserRecommendation.Key, reference = Model.UserDataModel.Reference})" method="post" novalidate>

        @Html.HiddenFor(m => m.UserDataModel.Reference)

        <span class="govuk-caption-l">
            Recommendation @(Model.GetCurrentIndex() + 1) of @Model.UserDataModel.UserRecommendations.Count 
        </span>
        <h1 class="govuk-heading-l">Fit new windows</h1>

        <p class="govuk-body">
            It looks like you have some single glazed windows in your home. Double or 
            triple glazed windows are much better at keeping the heat in, so would help 
            you keep warm while reducing your heating bills.  
        </p>

        <p class="govuk-body">
            The fuel bill savings from replacing windows are unlikely to pay back the 
            full installation cost, but there are other benefits such as reduced 
            maintenance and better sound proofing that may affect your decision. 
        </p>

        <p class="govuk-body govuk-!-margin-bottom-6">
            You can find more information on efficient windows and how to choose them at the
            <a class="govuk-link" target="_blank" href="https://www.bfrc.org/homeowners">
                British Fenestration Rating Council.<span class="govuk-visually-hidden">(opens in a new window)</span>
            </a>
        </p>
        
        <div class="govuk-warning-text govuk-!-margin-bottom-6">
            <span class="govuk-warning-text__icon  sea-warning-text__icon--long" aria-hidden="true">!</span>
            <strong class="govuk-warning-text__text">
                <span class="govuk-warning-text__assistive">Caution</span>
                If you live in a conservation area or listed building there may be limits on what 
                changes you can make to your windows. You should check with your local authority 
                to see what is allowed.
            </strong>
        </div>

        <h2 class="govuk-heading-m">Who this improvement is suitable for</h2>
        <p class="govuk-body">You should consider this improvement for your property if:</p>
        <ul class="govuk-list govuk-list--bullet govuk-!-margin-bottom-7">
            <li>
                You have any single glazed windows. 
            </li>
        </ul>

        <h2 class="govuk-heading-m ">What you could save</h2>
        <div class="govuk-grid-row govuk-!-margin-left-0 govuk-!-margin-bottom-7 govuk-!-margin-top-6">
            <div class="govuk-grid-column-one-half sea-install-costs">
                <span class="govuk-caption-m">This could cost</span>
                <h3 class="govuk-heading-l govuk-!-margin-bottom-1">£@Model.UserRecommendation.MinInstallCost - £@Model.UserRecommendation.MaxInstallCost</h3>
            </div>
            <div class="govuk-grid-column-one-half sea-yearly-savings">
                <span class="govuk-caption-m">This could save up to</span>
                <h3 class="govuk-heading-l govuk-!-margin-bottom-1">£@Model.UserRecommendation.Saving a year</h3>
            </div>
        </div>
        <dl class="govuk-summary-list govuk-!-margin-bottom-9">
                <div class="govuk-summary-list__row">
                    <dt class="govuk-summary-list__key govuk-!-width-two-thirds">
                        Will this cause disruption during installation?
                    </dt>
                    <dd class="govuk-summary-list__value sea-recommendation-impact govuk-!-padding-right-0">
                        <strong class="govuk-tag govuk-tag--yellow">MODERATE</strong>
                    </dd>
                </div>
                <div class="govuk-summary-list__row">
                    <dt class="govuk-summary-list__key govuk-!-width-two-thirds">
                        How long could this take to install?
                    </dt>
                    <dd class="govuk-summary-list__value sea-recommendation-impact govuk-!-padding-right-0">
                        <strong class="govuk-tag govuk-tag--yellow">1 OR 2 DAYS</strong>
                    </dd>
                </div>
            </dl>
            
            @(Html.GovUkRadiosFor(m => m.RecommendationAction,
                fieldsetOptions: new FieldsetViewModel
                {
                    Legend = new LegendViewModel
                    {
                        Html = @<text>
                                   <h1 class="govuk-fieldset__heading">
                                       What would you like to do with this recommendation?
                                   </h1>
                                </text>,
                        Classes = "govuk-fieldset__legend--l"
                    }
                }
                ))
            

            @if (Model.HasPreviousIndex())
            {
                <button name="command" value="goBackwards" class="govuk-button govuk-button--secondary" data-module="govuk-button">
                    Previous recommendation @(Model.GetCurrentIndex())
                </button>
            }
            @if (Model.HasNextIndex())
            {
                <button name="command" value="goForwards" class="govuk-button" data-module="govuk-button">
                    Next recommendation @(Model.GetCurrentIndex() + 2)
                </button>
            }
            else
            {
                <button name="command" value="goToActionPlan" class="govuk-button govuk-button" data-module="govuk-button">
                    Go to action plan
                </button>
            }
        </form>
    </div>
    <div class="govuk-grid-column-one-third">
        <aside class="sea-recommendation-side-panel" role="complementary">
            <h2 class="govuk-heading-m" id="subsection-title">Keep a copy</h2>
            <p class="govuk-body-s">
                <a href=# class="govuk-link">Print or email this recommendation</a>
            </p>
            <h2 class="govuk-heading-m" id="subsection-title">Your action plan</h2>
            @if (Model.GetSavedRecommendations().Count > 0)
            {
                <p class="govuk-body-s">
                    You have saved <strong>@Model.GetSavedRecommendations().Count</strong> recommended improvement.
                </p>
                <dl class="govuk-summary-list">
                    <div class="govuk-summary-list__row">
                        <dt class="govuk-summary-list__key govuk-!-width-one-half govuk-!-margin-bottom-0">
                            It could cost
                        </dt>
                        <dd class="govuk-summary-list__value govuk-!-width-one-half">
                            @Model.GetTotalInstallationCostText()
                        </dd>
                    </div>
                    <div class="govuk-summary-list__row">
                        <dt class="govuk-summary-list__key govuk-!-width-one-half govuk-!-margin-bottom-0">
                            It could save
                        </dt>
                        <dd class="govuk-summary-list__value govuk-!-width-one-half">
                            @Model.GetTotalSavingText()
                        </dd>
                    </div>
                </dl>
                <a href="@Url.Action("YourSavedRecommendations_Get", "EnergyEfficiency", new {reference = Model.UserDataModel.Reference})" class="govuk-link">View your action plan</a>
            }
            else
            {
                <p class="govuk-body-s">You haven’t saved any improvements yet.</p>
            }
        </aside>
    </div>
</div>